

<style>
.study-skills-graph
{
	float: left;
	margin: 20px 15px 0px 15px;
}
.preference
{
	width: auto;
}
#score-details
{
	margin-bottom: 20px;
}
#sstoolTip
{
	width: 20px;
	font-size: 16px;
	font-weight: bold;
	text-align: center;
	position: absolute;
	z-index: 100;
}
.ss-description-category
{
	margin-top: 10px;
}
.ss-description-category span
{
	font-weight: bold;
}
.ss-description-category fieldset legend
{
	font-weight: bold;
	background-color: #F1F1F1;
	border: 1px solid #333;
	padding: 3px 10px;
}
.ss-details-button
{
	padding: 1px 10px;
	margin-left: 10px;
	margin-bottom: 5px;
}
/*#sstoolTip:before
{
	content: ' ';
    position: absolute;
    width: 0;
    height: 0;
    left: 10px;
    top: 49px;
    border: 8px solid;
    border-color: #111111 transparent transparent #111111;
}
#sstoolTip:after
{
    content: ' ';
    position: absolute;
    width: 0;
    height: 0;
    left: 11px;
    top: 49px;
    border: 6px solid;
    border-color: #fff transparent transparent #fff;
}*/
#study-skills-preference h2 span
{
	font-weight: bold;
	font-size: 16px;
}
#score-details
{
	height: 440px;
}
</style>

{% block body %}
<h1>Study Skills</h1>
<div class="study-skills-block preference">
	{% for preference in course_preference %}
	<div id="study-skills-preference" value="{{ preference.sub_cat }} - {{ preference.description }}"><h2>Prefered Teaching Style : <span>{{ preference.sub_cat }}</span> </h2>This indicates that you prefer instructors who {{ preference.description }}</div>
	{% endfor %}
</div>
<div id="score-details">
	<div id="sstoolTip" style="display: none;"></div>
	{% for score in scores %}
		<div class="study-skills-graph">
		<div id="study-skills-{{ score.id }}"></div>
 			<input class="ss-details-button" type="button" value="Details" onclick="showDetails('{{ score.id }}')">
 		</div>
	{% endfor %}
</div>

{% for score in scores %}
	<script>
		barDistance = 70;
		var ssChart = Raphael("study-skills-{{ score.id }}", 275, 400);
		var ssCategory = ssChart.text(100, 25, "{{ score.category }}").attr({ "font-size": 20, "font-family": "Arial, Helvetica, sans-serif", "title": "{{ score.score }}" });
		var scaleLabel = 20;
	</script>
	<!-- the "Stragic approach" has 5 bars and needs to be handeled differently.-->
	{% if score.category == "Strategic approach" %}
		<script>
		// Drawing the scale on the graph
		for (i=0; i<285; i=i+57)
  		{
  		    var chartScale = ssChart.path("m45,"+(i+50)+" l190,0");
  		    var scaleText = ssChart.text(38, (i+50), scaleLabel+"");
  		    scaleLabel = scaleLabel-5;
  		}
		</script>
		{% for subcat in score.sub_cats %}
			<script>
				var ssBar = ssChart.rect(barDistance-15,275-({{subcat.sub_cat_score}}/16*180),30,({{subcat.sub_cat_score}}/16*180),3);
				// Set the color for the bars and the hover tooltip
				ssBar.attr({fill: "#6D95F3", stroke: "#777"}).hover(
					function(e){
						this.transform("s1.1").attr({"stroke-width": 3});
						$("#sstoolTip").html(this.attr('height')/11.25);
    					$("#sstoolTip").show();
    					$("#sstoolTip").offset({left:e.pageX-10,top:e.pageY-65});
					},
					function(){
						this.transform("s1").attr({"stroke-width": 1});
						$("#sstoolTip").hide();
					});
				//Setting the text labels for each bar and rotating them.
				var ssText = ssChart.text(barDistance, 320, "{{ subcat.sub_cat }}").translate(-64,0).rotate(310, barDistance, 230).attr({ "text-anchor": "end", "font-size": 11, "font-family": "Arial, Helvetica, sans-serif" });
				barDistance = barDistance+35;
			</script>
	    {% endfor %}
	    <!-- The other two approaches. -->
	{% else %}
		<script>
		// Drawing the scale on the graph
			for (i=0; i<285; i=i+57)
	  		{
	  		    var chartScale = ssChart.path("m59,"+(i+50)+" l155,0");
	  		    var scaleText = ssChart.text(52, (i+50), scaleLabel+"");
	  		    scaleLabel = scaleLabel-5;
	  		}
		</script>
		{% for subcat in score.sub_cats %}
			<script>
				var ssBar = ssChart.rect(barDistance,275-({{subcat.sub_cat_score}}/16*180),30,({{subcat.sub_cat_score}}/16*180),3);
				// Set the color for the bars and the hover tooltip
				ssBar.attr({fill: "#6D95F3", stroke: "#777"}).hover(
					function(e){
						this.transform("s1.1").attr({"stroke-width": 3});
						$("#sstoolTip").html(this.attr('height')/11.25);
    					$("#sstoolTip").show();
    					$("#sstoolTip").offset({left:e.pageX-10,top:e.pageY-65});
					},
					function(){
						this.transform("s1").attr({"stroke-width": 1});
						$("#sstoolTip").hide();
					});
				//Setting the text labels for each bar and rotating them.
				var ssText = ssChart.text(barDistance, 320, "{{ subcat.sub_cat }}").translate(-52,0).rotate(310, barDistance, 230).attr({ "text-anchor": "end", "font-size": 11, "font-family": "Arial, Helvetica, sans-serif" });
				barDistance = barDistance+35;
			</script>
	    {% endfor %}
    {% endif %}
{% endfor %}

<div id="ss-descriptions">
	{% for score in scores %}
		<div id="ss-description-{{ score.id }}" class="ss-description-category" style="display: none;">
			<fieldset>
				<legend>{{ score.category }}</legend>
			{% for subcat in score.sub_cats %}
			<p><span>{{ subcat.sub_cat }} - </span>{{ subcat.description }}</p>
			{% endfor %}
		</fieldset>
		</div>
	{% endfor %}
</div>

<script>
function showDetails(name)
{
	if( $('#ss-description-'+name).is(':visible')){
		$('.ss-description-category').hide(750);
	}else{
		$('.ss-description-category').hide(750);
		$('#ss-description-'+name).show(750);
	}
}

</script>

{% endblock %}
